From 2613f1749a805a4e79905c3cea639a5fc671b51d Mon Sep 17 00:00:00 2001
From: Daniel Veillard <veillard@redhat.com>
Date: Fri, 25 Jul 2008 08:42:05 +0000
Subject: [PATCH] wrong open() failure detection

Guido Trotter pointed out a wrong open() failure detection
---
 src/qemu_driver.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/src/qemu_driver.c b/src/qemu_driver.c
index aeff782..694e26f 100644
--- a/src/qemu_driver.c
+++ b/src/qemu_driver.c
@@ -479,7 +479,7 @@ static int qemudOpenMonitor(virConnectPtr conn,
     char buf[1024];
     int ret = -1;
 
-    if (!(monfd = open(monitor, O_RDWR))) {
+    if ((monfd = open(monitor, O_RDWR)) < 0) {
         qemudReportError(conn, NULL, NULL, VIR_ERR_INTERNAL_ERROR,
                          _("Unable to open monitor path %s"), monitor);
         return -1;
-- 
1.5.6.3

